{
"id": "common",
"functions": [
{
"id": "FileIsaBlob",
"names": ["File isa Blob"],
"cost": 0,
"templates": [{
"code": "$next",
"in": [{"type": "File", "name": "file"}],
"out": [{"type": "Blob", "name": "file"}]
}]
},
{
"id": "DataUrlIsaUrl",
"names": ["DataUrl isa url"],
"cost": 0,
"templates": [{
"code": "$next",
"in": [{"type": "DataUrl", "name": "dataUrl"}],
"out": [{"type": "url", "name": "dataUrl"}]
}]
},
{
"id": "BlobUrlIsaUrl",
"names": ["BlobUrl isa url"],
"cost": 0,
"templates": [{
"code": "$next",
"in": [{"type": "BlobUrl", "name": "blobUrl"}],
"out": [{"type": "url", "name": "blobUrl"}]
}]
},
{
"id": "UrlIsaString",
"names": ["url isa string"],
"cost": 0,
"templates": [{
"code": "$next",
"in": [{"type": "url", "name": "url"}],
"out": [{"type": "string", "name": "url"}]
}]
},
{
"id": "inputFileChangeEvent",
"doc": "https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications#Specification",
"names": ["input file change event", "<input type='file'>", "file input"],
"templates": [{
"in": [],
"out": [{"type": "File", "name": "file"}],
"code": "var inputFile = document.createElement(\"input\");\ninputFile.type = \"file\";\ninputFile.addEventListener(\"change\", function(event) {\n\tvar file = inputFile.files[0];\n\t$next\n});\ndocument.body.appendChild(inputFile);\n"
}]},
{
"id": "fileDragDrop",
"doc": "http://www.html5rocks.com/en/tutorials/file/dndfiles/",
"names": ["drag and drop file", "file drag drop"],
"templates": [{
"in": [],
"out": [{"type": "File", "name": "file"}],
"code": "var dropElement = document.createElement(\"div\");\ndropElement.textContent = \"Drag and drop here.\";\ndropElement.style.border = \"dashed 2px black\";\ndropElement.addEventListener(\"drop\", function (event) {\n\tevent.stopPropagation();\n\tevent.preventDefault();\n\n\tvar file = event.dataTransfer.files[0];\n\t$next\n});\ndropElement.addEventListener(\"dragover\", function (event) {\n\tevent.stopPropagation();\n\tevent.preventDefault();\n\tevent.dataTransfer.dropEffect = 'copy';\n});\ndocument.body.appendChild(dropElement);\n"
}]},
{
"id": "FileReader.readAsArrayBuffer",
"doc": "http://docs.webplatform.org/wiki/apis/file/FileReader/readAsArrayBuffer",
"names": ["readAsArrayBuffer", "FileReader.readAsArrayBuffer"],
"cost": 2,
"templates": [{
"in": [{"type": "Blob", "name": "blob"}],
"out": [{"type": "ArrayBuffer", "name": "arrayBuffer"}],
"code": "var reader = new FileReader();\nreader.addEventListener(\"load\", function() {\n\tvar $arrayBuffer = reader.result;\n\t$next\n});\nreader.addEventListener(\"error\", function() { console.error(reader.error); });\nreader.readAsArrayBuffer($blob);\n"
}]},
{
"id": "FileReader.readAsDataURL",
"doc": "http://docs.webplatform.org/wiki/apis/file/FileReader/readAsDataURL",
"names": ["readAsDataURL", "FileReader.readAsDataURL"],
"cost": 4,
"templates": [{
"in": [{"type": "Blob", "name": "blob"}],
"out": [{"type": "DataUrl", "name": "dataUrl"}],
"code": "var reader = new FileReader();\nreader.addEventListener(\"load\", function() {\n\tvar $dataUrl = reader.result;\n\t$next\n});\nreader.addEventListener(\"error\", function() { console.error(reader.error); });\nreader.readAsDataURL($blob);\n"
}]},
{
"id": "FileReader.readAsText",
"doc": "http://docs.webplatform.org/wiki/apis/file/FileReader/readAsText",
"names": ["readAsText", "FileReader.readAsText"],
"cost": 2,
"templates": [{
"in": [{"type": "Blob", "name": "blob"}],
"out": [{"type": "string", "name": "str"}],
"code": "var reader = new FileReader();\nreader.addEventListener(\"load\", function() {\n\tvar $str = reader.result;\n\t$next\n});\nreader.addEventListener(\"error\", function() { console.error(reader.error); });\nreader.readAsText($blob);\n"
}]},
{
"id": "createElementImg",
"names": ["Create image element", "document.createElement(\"img\")", "new Image()"],
"cost": 2,
"templates": [{
"in": [{"type": "url", "name": "imageUrl"}],
"out": [{"type": "HTMLImageElement", "name": "image"}],
"code": "var $image = document.createElement(\"img\");\nimage.addEventListener(\"load\", function() {\n\tdocument.body.appendChild(image);\n\t$next\n});\nimage.addEventListener(\"error\", function() { console.error(\"image load error\"); });\nimage.src = $imageUrl;\n"
}]},
{
"id": "imgSrc",
"names": ["img.src", "image source"],
"templates": [{
"in": [{"type": "HTMLImageElement", "name": "image"}],
"out": [{"type": "url", "name": "imageUrl"}],
"code": "var $imageUrl = $image.src;\n"
}]},
{
"id": "createObjectURL",
"doc": "http://docs.webplatform.org/wiki/apis/file/URL/createObjectURL",
"names": ["createObjectURL", "window.URL.createObjectURL"],
"templates": [{
"in": [{"type": "MSStream", "name": "blob"}],
"out": [{"type": "BlobUrl", "name": "blobUrl"}],
"code": "var $blobUrl = URL.createObjectURL($blob);\n$next"
}]},
{
"id": "revokeObjectURL",
"doc": "http://docs.webplatform.org/wiki/apis/file/URL/revokeObjectURL",
"names": ["revokeObjectURL", "window.URL.revokeObjectURL"],
"templates": [{
"in": [{"type": "BlobUrl", "name": "blobUrl"}],
"out": [],
"code": "URL.revokeObjectURL($blobUrl);\n$next"
}]}
]}
